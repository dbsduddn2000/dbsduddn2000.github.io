{% assign emptyarray = "" | split: "," %}
{% assign data = site.data[include.data] | default: site[include.data] | default: emptyarray %}

{%- comment -%}
태그 필터링 (대소문자 무시)
{%- endcomment -%}
{% if include.tag_filter %}
  {% assign tag = include.tag_filter | downcase %}
  {% assign filtered_data = "" | split: "," %}
  {% for d in data %}
    {% assign tag_str = d.tags | join: "," | downcase %}
    {% if tag_str contains tag %}
      {% assign filtered_data = filtered_data | push: d %}
    {% endif %}
  {% endfor %}
  {% assign data = filtered_data %}
{% endif %}

{% for d in data %}
  {% assign style = d.style | default: include.style %}
  {% include {{ include.component | append: ".html" }}
    affiliation=d.affiliation
    author=d.author
    authors=d.authors
    buttons=d.buttons
    caption=d.caption
    content=d.content
    date=d.date
    description=d.description
    excerpt=d.excerpt
    height=d.height
    icon=d.icon
    id=d.id
    image=d.image
    last_modified_at=d.last_modified_at
    link=d.link
    lookup=d.lookup
    name=d.name
    publisher=d.publisher
    repo=d.repo
    role=d.role
    slug=d.slug
    style=style
    subtitle=d.subtitle
    tags=d.tags
    text=d.text
    title=d.title
    tooltip=d.tooltip
    type=d.type
    url=d.url
    width=d.width
  %}
{% endfor %}
